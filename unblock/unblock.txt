Блокировки и решения.

0 бла-бла интро
В последнее время разные ведомства значительно продвинули техническую грамотность населения путем блокирования даже самых безвредных но полезных ресурсов. Одна блокировка википедии чего стоит. В целом, повышение грамотности населения – это хорошее следствие той безумной политики которую продвигают некоторые.
Тут почему-то очень хочется сослаться на классиков 451 градус по фаренгейту, общество уничтожало книги, и тогда изгои, стали спасать их путем выучивания наизусть.
Так и тут - общество борется с информацией и по этому изгои становятся более опытными в работе с информацией
В этих ваших интернетах (тут сслыка на лурк) есть же over 9000 (еще одна ссылка на лурк) текстов описывающих все то что я хочу описать. Зачем же я хочу это описать еще раз? наверное потому что если я сделаю это для своих друзей и знакомых, им будет приятно что я постарался для них. А может быть потмоу что написание текста позволит мне самому разобраться с проблемой. 

1 как блокируют
Для подробного описания того как блокируют доступ к разным материалам нужно наверное очень глубоко углубляться в то как функционирует интернет. Но так глубоко никому не нужно, ибо те кто понимают такие детали не нуждаются в подобных инструкциях, а те кто нуждаются - тем такие детали не нужны и усложнят доступ к информации действительно нужной.

Тут я попробую использовать терминологию, а первые тестовые прогоны текста на живых людях покажут на сколько нужно это разжевать.

а) блокировка на уровне dns
Идея такой блокировки состоит в том что провайдер, подменяет ip адрес настоящего сайта на какой-то другой, таким образом когда пользователь в стамбуле в браузере вводит например facebook.com, провайдер обслуживающий dns запросы пользовательского компьютера возвращает не адреса принадлежащие фейсбуку а какие-то другие, на которых вместо сайта facebook.com будет страница-заглушка. 
два примечания на эту тему: а1) по такой схеме могут дейстовать не только злые правители но и другие злоумышленники, тогда на странице на которую отправят ваш компьютер, может быть не сайт facebook.com а другой, но внешне напоминающий сам facebook.com и так при вашей невнимательнсти можно отдать пароль от facebook.com каким нибудь злоумышлинникам.
a2) если вы хотитет чтоб ваш компьютер никогда не попал на какой-нибудь сайт, можно по этой же схеме установить страницу-заглушку прямо на компьютере, тогда например вы можете сами себе запретить ходить на facebook.com, как уже давно делают многие параноики. 

б) блокировка ip адреса
тут схема тоже очень простая. на сетевом уровне, доступ к определенным адресам реорганизуется путем исправления отдельных маршрутов к отдельным адресам. Наверно сложно сформулировано. фактически провайдер (как конечный провайдер предоставляющий услугу пользователю, например билайн, так и операторы связи которые обслуживают других провайдеров, например ростелелком). Тогда компьютер получив нужный ip адрес из dns пытается установить с ним соеденение, но так же попадает на страницу заглушки. Прямо сейчас это самый распространенный способ блокировок в России. Он достаточно дешев в реализации для любых типов операторов. Большой минус этого спосба состоит в том что при попытке заблокировать одну отдельно взятую страницу в википедии, или единственный ролик в ютубе, блокируестя весь ресурс с миллионами других страниц. Это происходи по тому что все страницы отдаются с одного и того же адреса. 

в) блокировка содержимого по средствам dpi
это сложная штука. сложная и дорогая. dpi - deep packet inspection. для реализации такой блокировки используется специальное дорогое оборудование которое пропускает через себя весь трафик пользователя и стараетс заглянуть в каждый пакет (данные в интернете передаются в пакетах, а не цельными кусками как многим бы хотелось). для того чтоб заглянуть в каждый пакет, а потом сравнить его содержимое со базой запрещенного содержимого нужно много времени и вычислительных ресурсов. именно по этому такое оборудование дорогое. (не уверен что тут понятно.. но суть в том что обычно сетевое оборудование смотрит только на заголовки пакетов, которые описаны по очень четким правилам, и по этому обработка пакетов просходит относительно дешево и быстро. если же оборудованию нужно смотреть не только на заголовок но и на содержимое пакета, то ему нужно проделать в десятки а то и стотни раз больше вычислений, перекладываний данных из памяти в сеть и обратно. очень дорого.). Если бы такое обороудование было у всех провайдеров, то тогда вероятно мы бы меньше страдали от закрытых ютубов и википедий, а страдали бы только от того что нельзя посмотреть навального на марше или узнать какие сайдэфекты при курении дмт.

Но тут есть маленькая тонкость которая очень много менеят.

Дело в том что не весь трафик одинаково лего смотреть (относительно легко конечно, как я сказал выше). Обычный трафик смотреть технически труда не составляет. Пакет содержит в себе данные в которые можно заглянуть. Но сейчас в интернете стало очень популярно (а по моему крайне необходимо) передавать данные в шифрованых соеденениях. Вероятно вы даже не замечаете как часто вы используете зашифрованое соеденение (https, ssl - вот ключевые слова). Сайты стараются подталкивать пользователей к использованию шифрованных соеденений исключительно в интересах пользователей. Ведь если открытый трафик легко смотреть, то это могут исопльзотвать злоумышленники, и тогда можно было бы подсмотреть пароль от вашей почты, социальной сети, номера ваших банковских кароточек и прочего. Для этого сайты предлагают вашим браузерам использвать зашифрованное соеденение. А вот об такие пакеты почти все оборудование dpi либо сломает зубы, либо цена обработки будет безбожной (я сейчас не оскорбил чувств верующих? Надеюсь оскорбились только атеисты, но их у нас можно оскорблять в чувствах)
кажетя про тонкость я пояснил, теперь нужно показать что она меняет:
даже при наличии оборудования dpi у провайдера, шифрованый трафик проходит мимо такого оборудования по вышеизложенным причинам, и тогда к нему обычно применяется метод блокировки из пункта б). что делает dpi не просто дорогим но еще и бессмысленным.
но тут есть еще один интересный сайдэфект: в ряде случаев, операторы связи, по причине нужды заглянуть в шифрованую сессию могут выступать как атакующих хаккер, устанавив сервис который обманывает наш браузер, который устанавливает соеденение с сервисом оператора, расшифровывате трафик, пропускает его через dpi и потом далье отправляет на заказанный адрес. Такая атака называется man in the middle. Есть много деталей вокруг, но наверное не стоит перегружать тут текст, важно помнить - ВСЕГДА СТОИТ ПРОВЕРАТЬ СЕРТИФИКАТ ВЫДАННЫЙ САЙТОМ!

г) другие
можно поискать еще много других способов блокировки доступа к сайтам, но кажется что они маргиналны и можно не захломлять себе голову. Просто знать что всегда можно как-нибудь испортить жизнь человеку.

2 обзор средств обхода

средства обхода зависят от средств блокировки, так для обхода блокировки по средствам DNS, в турции очень много пользователей научилось использовать не провайдерские резолверы (dns сервер называют резолвером потому что он совершает resolve имени в ip адрес). Яндекс и Гугл предоставляет свои сервера для трансляции имен в адреса, и в настройках ваших компьютеров можно указать эти сервера. Обычно ни гугл ни яндекс не совершают подмен в этом месте потому что они не являются операторами связи и по этому на них требование закона о связи в этом месте не распростоняется.

Если говорить о том как принятно блокировать сайты в России, то заменой резолвера не обойтись. Тут нам на помощь приходят стредства изначально созданные для совсем других целей.
VPN и ТОR два слова на три буквы. 
с чего начать? с чего начать? Начну с TOR потмоу что он сложный.

TOR сделали ребята которые хотели добиться анонимости в сети. По возможности полной анонимности. На столько полной что даже появились красивые маркетинговые термины про TOR и сайты доступнве в этой сети, т.н. hidden - скрытые сайты.
TOR работает примерно так. тор-браузер при старте получает неким образом список "точек входа", через которые он будет пытаться попатсь на другие сайты, скрыте или доступные. Он отправляет запрос на точку входа. точка входа служит ретранслятором запросов. Она сама никогда не отправляет запрос на нужный сайт, она пересылает этот запрос на другую тор-ноду (tor-node) - другой узел сети tor который нужен для того чтоб развязать местоположение запрашивающего и сайта. промежуточная тор-нода отправляет запрос либо на следующую промежуточную либо на ноду через которую осуществляется выход из сети тор. 
(тут должна быть илюстрация где нарисована сеть, точка входа точка выхода промежуточные ноды копьютер пользователя и сайт куда он идет).
при подобной организации хождения данных, ни на одной ноде никогда не будет полного набора информации: кто-куда. Потмоу что точка входа знает кто, но незнает куда, точка выхода знает куда но не знает кто. (тут я пропрошу меня перепроверить у уважаемых экспертов).
Такя схема работы сети очень безопасна (не идеально, но пока было мало хороших атак на тор, а те что были, были довольно дорогими). 
К минусам этой схемы стоит отнести ее скорость - так как сеть всегда передает данные через лишние с точки зрения производительности но ключевые с точки зрения безопасности ноды, а к тому же часто выбираются такие ноды чтоб они были заведомо в другом государстве, то запросы и ответы очень медлено отрабатывают. Что в наше время терпеть трудно. Тут следует сделать врезку о том что удобство и безопасность это обычно концы одной палки.
Итого какой главный вывод о том зачем нужен тор - анонимность. 
Из этого же следует что довольно глупо использвать тор в тех местах где вы раскрываете свою личность. Например ходя на сайт госуслуг через тор вы как бы с двух сторон себя идентифицируете и дома и на сайте, тогда тор вам совсем бесполезен и более того, можно попробовать проследить вас ваше местоположение и тогда когда вы пойдете на другие сайты где захотите получить анонимность, вас можно с большей вероятностью идентифицировать и там. Наверное что то нужно сказать про i2c но про него я вообще ничего не знаю. Нужно разобраться.

Тепреь немного про VPN.
VPN как вы наверное знаете это аббривиатура которая расшифровывается как virtual privet netwokr. Все протоколы vpn изначально придумывались для того чтоб сотруднику который работает вне часной сети компании, например из командировки, иметь возможность получить доступ ко всем ресурсам внутренней сети, при этом скрыть эти ресурсы от посторониих вне сети. Т.о. устанавливая vpn соеденение поверх интернета, сеть компании как бы расширялась выносом на компьютер сотрудника.
Что можно извлечь из этой мысли? Компьютер устанавливает _еще_одно_ соеденение поверх уже существуещего. И использует это новое соеденение для передачи всех или части данных. Визуально это часто показывают в виде тунеля в туче. Такого чтоб не видно что в этом туннеле происходит если смотреть на него со стороны тучи. Обычно эти протоколы предусматривают так же сжатие и шифрование данных. Для того чтоб из интерента было никому не видно что передается. 
Как это помогает от блокировок? Так: ваш компьютер начинает ходить в интернет не из того места где привык ваш провайдер вас ловить а из того куда установленно соеденение. Например из европы (не обольщайтесь, там хватает своих негодяев и других блокировок). В отличии от тора тут скорость соеденения падает на фиксированую величину которая обусловленна дополнительным соеденением, так например если вы в москве а ваш впн-концентратор (какое энтерпрайзное слово та) находится например в голандии, то тогда появляется дополнительные 50ms задержки. Мне кажется то это очень приемлимая цена за то чтоб вам не мешали жить.
Чем удобно использвать впн еще? его удобно использовать тем что во все современные ос впн клиенты (умеющие некоторое количество протоколов) встроены из коробки. Т.е. вам не нужно ставить дополнительных програм для некоторых видов соеденений. Да, я сказал во все современные ос, это будет так же работать на ваших смартфонах. Это очень удобно. 

3 выбор средств обхода

Тут стоит изучить предложения которые существуют на рынке. Я совсем не смотрел, но попробую изучить. Есть компании которые за 1-2 доллара в месяц предоставляют вам возможность использования их впн концентраторов и помогают с настройкой (выдают инструкции). кажется это очень удобно и доступно для большинства.
В ряде случаев можно свомещать тор и впн. Я бы так рекомендовал делать если вы хотите искать информацию в интернете. Только убедитесь что вы не логинились в гугл своим торбраузером. Тогда ваша интернет сессия будет выглядеть достаточно безопасной. 
А фейсбук и порнхаб можно смотреть просто через впн.

Мне близка идея не использовать комерческие решения от впн провайдеров а завести на свою малую группу (семью-друзей-однокурсников) свой впн-концентратор. в самом простом случае это будет стоить 5 долларов в месяц на всех, а настроить его для продвинутого пользователя труда не составит.
Почему мне нравится такая идея - потому что больших провайдеров впн власти скоро тоже навчнут блокировать, а ваш хост в до или на амазоне никому не нужен, ну и если вы умеете уже быстро это настраивать, то заблокированный хост в течении часа вы сможете поднять на новом месте.

Тор, есть некоторое количетво браузеров реализовавших в себе тор, но я мало их исхользовал, вот для айфона а вот для компьютеров.

4 блабла финита

тут необходимо вставить список использованной литературы, ссыкли на то откуда взяты изображения, благодарности всем разработчикам делающим нам возможности жить дальше.
Наверное красиво было бы указать лицензию для этого текста Creative Common, может это придаст ему большей значимости. И да, поблагодарить гитхаб за хостинг этого текста, хотя гитхаб тоже вроде бы блокировали. 
